import re
import sys

file_name=sys.argv[1]

file=open(file_name,"r")
lines=file.readlines()

ip_addr=[]
web=[]
dllList=[]
libList=[]

for line in lines:
	ip=re.search("\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}",line)
	if ip!=None:
		ip_addr.append(ip.group())
	
	website=re.search("(http|https|ftp|ssh|ftps)[^\(\)\n\s]*",line)
	if website!=None:
		web.append(website.group())

	dll=re.search(".*(.dll)",line)
	if dll!=None:
		dllList.append(dll.group())

	lib=re.search("([^\d\t\W]*Process[^\d\t\W]*|[^\d\t\W]*Destroy[^\d\t\W]*|[^\d\t\W]*Library[^\d\t\W]*|[^\d\t\W]*Delete[^\d\t\W]*|[^\d\t\W]*Create[^\d\t\W]*|[^\d\t\W]*Module[^\d\t\W]*|[^\d\t\W]*Address[^\d\t\W]*|[^\d\t\W]*Crypt[^\d\t\W]*)",line)
	if lib!=None:
		libList.append(lib.group())		
	

print(ip_addr)
print(web)
print(dllList)
print(libList)

